<!DOCTYPE html>
<html>
<head>
  <title>Locatability</title>
  <script src="Locatability.js"></script>
  <script src="Stimulus.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
  <link rel="stylesheet" href="styles.css"> 
</head>


<body>
  <div id="locatability" style = "height: 15vh; width: 25vw;position: relative;">
      <b  id = "title" style ="  position: absolute;
      width: 20vw;
      top: 5%;
      left: 3%;">Locatability</b>
      <span class="help-icon" id="helpIcon">i</span>
      <b  style ="  position: absolute;
      width: 20vw;
      top: 60%;
      left: 3%;
      font-size: 1.5vw;
      font-family: Arial, sans-serif;
      color: #858585;">Choosing Visual Variables to Support Visual Location</b>
  </div>

  <div class="overlay" id="overlay"></div>
  <div class="popup" id="popup">
      <div class="popup-header">
        <div class="header-title">HOW TO USE</div>
        <span class="close-btn" id="closeBtn">&times;</span>
    </div>
    <div style = "padding:10px">
      <p>This is a tool that helps you select visual variables for your visualization and UX design. 
        The tool models the locatability of seven visual variables with respect to three factors - Layout, Set Size, and 
        Target Location. To use the tool, </p>
      <p style ="font-size: 1.5vw;font-family: Arial, sans-serif; color: #9498a0;">1. Choosing the visual variables that are available for your design by toggling on / off the variables at top.</p>
      <p style ="font-size: 1.5vw;font-family: Arial, sans-serif; color: #9498a0;">2. Choosing a layout for your design.</p>
      <p style ="font-size: 1.5vw;font-family: Arial, sans-serif; color: #9498a0;">3. Choosing a factor from set size and target location and input a value for it. Set size is the number of objects that your design will have. 
        Target location describes the distance from your target to the center of the display.
      <p style ="font-size: 1.5vw;font-family: Arial, sans-serif; color: #9498a0;">4. Selecting the appropriate visual variable(s) based on our recommendations (Shown in bottom left).</p>
      </p>
    </div>

  </div>

  <div id = "featureBanner">
      <!-- <input type="search" id="target location" value = "set size"  onkeydown="OnKeyDown(event)"> -->
      <div class = "feature-container" style ="left: 0%;">
        <input type="checkbox" id="Luminance" value = "Luminance" checked  onclick="toggleFeatures(this)">
        <label class = "feature-text">Luminance</label>
        <div class="exampleRect" style ="background-color: white"></div>
        <div class="exampleRect" style ="background-color: black; left: 75%;"></div>
      </div>
      <div class = "feature-container" style ="left: 14%;">
        <input type="checkbox" id="D3Color" value = "D3Color" checked  onclick="toggleFeatures(this)">
        <label class = "feature-text" >D3Color</label>
        <div class="exampleRect" style ="background-color: #08519c"></div>
        <div class="exampleRect" style ="background-color: #bdd7e7; left: 75%;"></div>
      </div>
      <div class = "feature-container" style ="left: 28%;">
        <input type="checkbox" id="Hue" value = "Hue" checked  onclick="toggleFeatures(this)">
        <label class = "feature-text" >Hue</label>
        <div class="exampleRect" style ="background-color: #ee9590"></div>
        <div class="exampleRect" style ="background-color: #87b0e5; left: 75%;"></div>
      </div>

      <div class = "feature-container" style ="left: 42%;">
        <input type="checkbox" id="Size" value = "Size" checked  onclick="toggleFeatures(this)">
        <label class = "feature-text" >Size</label>
        <div class="exampleCir" ></div>
        <div class="exampleCir" style =" left: 75%; bottom: 20%;border-radius:1.34vh; width: 1.34vh; height: 1.34vh;"></div>
      </div>
      <div class = "feature-container" style ="left: 56%;"> 
        <input type="checkbox" id="Orientation" value = "Orientation" checked  onclick="toggleFeatures(this)">
        <label class = "feature-text" >Orientation</label>
        <div class="exampleRect" style =" transform: rotate(45deg);"></div>
        <div class="exampleRect" style =" left: 75%;"></div>
      </div>
      <div class = "feature-container" style ="left: 72%;">  
        <input type="checkbox" id="Length" value = "Length" checked  onclick="toggleFeatures(this)">
        <label class = "feature-text" >Length</label>
        <div class="exampleRect" ></div>
        <div class="exampleRect" style =" left: 75%; height: 4vh;"></div>

      </div>
      <div class = "feature-container" style ="left: 86%;">
        <input type="checkbox" id="Shape" value = "Shape" checked  onclick="toggleFeatures(this)">
        <label class = "feature-text" >Shape</label>
        <div class="exampleRect"  style ="width: 2.38vh; height: 7.13vh;  transform: rotate(45deg);"></div>
        <div class="exampleRect"  style ="width: 2.38vh; height: 7.13vh;  transform: rotate(-45deg);"></div>
        <div class="exampleCir" style =" left: 75%;"></div>
      </div>
  </div>

  <div id="inputField">
      <div id = "layouts" class = "factor-container">
        <b class ="factor-des">Pick a layout for your design:</b><br>
        <input type="radio" style ="margin-top: 5%;" id="gridded" data-clicked="false" value = "gridded"  onclick="toggleLayouts(this)">
        <label class = "factor-text"  for="gridded"> Grid Layouts </label>
        <input type="radio" id="nongridded" data-clicked="true" value = "nongridded"  onclick="toggleLayouts(this)">
        <label class = "factor-text"  for="nongridded"> Non-Grid Layouts </label>
      </div>

      <div id = "numfactors" class = "factor-container" style = "border-bottom:0; height: 7vh;">
        
        <div class="tooltip-container">
          <b class ="factor-des">Pick a factor and input a value for it:</b>
          <span class="tooltip-text">Due to experiment constraints and potential interactions, the set size and target location cannot be specified simultaneously. When one is provided, the other is assigned randomly.</span>
        </div><br>
        <input type="radio" style ="margin-top: 5%;" id="setSize" data-clicked="false" value = "Set Size"  onclick="toggleSetSize(this)">
        <label class = "factor-text"  for="setSize"> Set Size </label>
        <input type="radio" id="tarLocation" data-clicked="true" value = "Target Location"  onclick="toggleTarLocation(this)">
        <label class = "factor-text"  for="tarLocation"> Target Location </label>
      </div>

      <div id = "factorSlider" class = "factor-container" style = "height: 7vh;">
        <input type="range" style ="margin-top: 5%;" id="theSlider" min="12" max="768" step="1" value="12">
        <input type="number" style="width: 3vw;" id="theNum" min="12" max="768" step="1" value="12">
      </div>

      <!-- <div id = "setsizes" class = "factor-container">
        <button id="SetSizeBtn" class = "factor-btn" onclick="clickSetSize(this)">Set Size</button>
        <input type="range" style ="margin-top: 5%;" id="SetSizeslider" min="12" max="768" step="1" value="12">
        <input type="number"  id="SetSizeNum" min="12" max="768" step="1" value="12">
      </div>

      <div id = "tarLocation" class = "factor-container" style ="background-color: #f0f0f0;">
        <button id="TarLocBtn" class = "factor-btn" onclick="clickTarLoc(this)">Target Location</button>
        <input type="range" style ="margin-top: 5%;" id="TarLocslider" min="0" max="0.8" step="0.01" value="0">
        <input type="number"  id="TarLocNum" min="0" max="0.8" step="0.01" value="0">
      </div> -->
  </div>

  <div id = 'output-txt' style ="width: 25vw; 
            background-color: #d0d1e6;
            border-bottom: 1px solid #000;
            word-wrap: break-word; /* Break long words */
            white-space: normal; /* Normal whitespace handling */
              ">
    <b id = 'outtxt1' style ="  position: relative; text-align: center; left: 2%;">Based on your settings, we suggest utilizing</b>
    <b id = "visualVariable"  style ="  position: relative;
    left: 2%;
    font-size: 1.5vw;
    font-family: Arial, sans-serif;
    background-color: #f39c12;
    color: #000;">Luminance </b><br>
    <b id = 'outtxt2'  style ="  position: relative; left: 2%;">which will take approximately</b>
    <b id = "taskTime"   style ="  position: relative;
    left: 2%;
    font-size: 1.5vw;
    font-family: Arial, sans-serif;
    background-color: #f39c12;
    color: #000;">631</b>
    <b id = 'outtxt3'  style ="  position: relative; left: 2%;"> milliseconds to find the target.  </b>
  </div>

  <!-- Div of the output table -->
  <div id="output-container" style ="position: relative; top: 0; width: 25vw; background-color: #d0d1e6;">
  
  </div>

  <div id="stimulus-container" style ="background-color: #808080;"></div>

  <div id="correct-message-window" class="modal">
    <div class="modal-content">
      <!-- <span class="close"  onclick="closeModal('correct-message-window')">&times;</span> -->
      <h2>BINGO</h2>
      <p>You found the target!</p>
    </div>
  </div>
  <!-- Info window which provide infomation about the model -->
  <!-- <div id="info-window" class="modal">
    <div class="modal-content">
      <span class="close"  onclick="closeModal('info-window')">&times;</span>
      <h2>BINGO</h2>
      <p>You found the target!</p>
    </div>
  </div> -->
</body>
<script>
  document.getElementById('nongridded').checked = true;
  document.getElementById('setSize').checked = true;
  //document.getElementById('setsize').addEventListener('input', updateSetSize);
  document.addEventListener('DOMContentLoaded', () => {
    const Slider = document.getElementById('theSlider');
    const NumberInput = document.getElementById('theNum');
    const radio = document.getElementById("setSize");
    // Update number input when slider value changes
    Slider.addEventListener('input', () => {
      NumberInput.value = Slider.value;
      if(radio.checked)
        updateSetSize(Slider.value);
      else
        updateTarLoc(Slider.value);
    });

    // Update slider when number input value changes
    NumberInput.addEventListener('input', () => {
      Slider.value = NumberInput.value;
      updateSetSize(NumberInput.value);
      if(radio.checked)
        updateSetSize(Slider.value);
      else
        updateTarLoc(Slider.value);
    });

    // TLslider.addEventListener('input', () => {
    //   TLnumberInput.value = TLslider.value;
    //   updateTarLoc(TLslider.value);
    // });

    // // Update slider when number input value changes
    // TLnumberInput.addEventListener('input', () => {
    //   TLslider.value = TLnumberInput.value;
    //   updateTarLoc(TLnumberInput.value);
    // });
  });

  // To set the how to use popup window
  const helpIcon = document.getElementById('helpIcon');
  const popup = document.getElementById('popup');
  const overlay = document.getElementById('overlay');
  const closeBtn = document.getElementById('closeBtn');

  helpIcon.addEventListener('click', () => {
      popup.style.display = 'block';
      overlay.style.display = 'block';
  });

  closeBtn.addEventListener('click', () => {
      popup.style.display = 'none';
      overlay.style.display = 'none';
  });

  overlay.addEventListener('click', () => {
      popup.style.display = 'none';
      overlay.style.display = 'none';
  });

  var Feature ={
  targetShape: "rectangle",
  distractorShape: "rectangle",
  targetColor: "hsl(0, 0%, 100%)",
  distractorColor: "hsl(0, 0%, 0%)",
  tdSizeRatio: 1,//the ratio between target size and distractor size
  tdLengthRatio: 1, //the ratio between target length and distractor length
  targetAngle: 0,
  distractorAngle: 0,
  curvature: null,
  closure: null,
  intersection: null,
  terminator: null,
  activeFeature: "Hue"
}

  // The data structure that store all necessary factor info for an experiment
  var Factor ={
    targetNumber: 1,
    elementNumber: 12,
    targetLocation: {}, //Has 4 variables - left, right, top, middle 
    orientation: 0,
    spatialPattern: null, //string: "Gridded", "Randomized"
    proximity : null,  // type: float
    activeFactor: "None",
    row: 0,
    col: 0
  }
  calcuLocatability();
  // generateStimulus(Feature,Factor); 
  // createTable(["Luminance"],[629]);
</script>
</html>
